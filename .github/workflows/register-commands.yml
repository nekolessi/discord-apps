name: Register Slash Commands


on:
workflow_dispatch:
inputs:
scope:
description: 'Where to register commands (guild|global)'
default: 'guild'
required: true
type: choice
options: [guild, global]


jobs:
register:
runs-on: ubuntu-latest
permissions:
contents: read
env:
DISCORD_TOKEN: ${{ secrets.DISCORD_TOKEN }}
APP_ID: ${{ secrets.APP_ID }}
GUILD_ID: ${{ secrets.GUILD_ID }}
NODE_ENV: production
steps:
- uses: actions/checkout@v4


- uses: actions/setup-node@v4
with:
node-version: 20
cache: 'pnpm'


- uses: pnpm/action-setup@v4
with:
version: 9


- name: Install deps
run: pnpm install --frozen-lockfile || pnpm install


- name: Register commands (guild)
if: ${{ github.event.inputs.scope == 'guild' }}
run: pnpm register:guild


- name: Register commands (global)
if: ${{ github.event.inputs.scope == 'global' }}
run: pnpm register:global